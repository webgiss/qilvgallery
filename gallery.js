var e=new Promise((function(e){if("complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll)setTimeout((function(){return e()}),1);else{var t=function(){e(),document.removeEventListener("DOMContentLoaded",t,!1)};document.addEventListener("DOMContentLoaded",t,!1)}}));function t(e,t,r){return t=h(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,n()?Reflect.construct(t,r||[],h(e).constructor):t.apply(e,r))}function n(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(n=function(){return!!e})()}function r(){r=function(){return t};var e,t={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function h(e,t,n,r){var i=t&&t.prototype instanceof m?t:m,a=Object.create(i.prototype),s=new L(r||[]);return o(a,"_invoke",{value:A(e,n,s)}),a}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var d="suspendedStart",f="executing",y="completed",v={};function m(){}function g(){}function _(){}var b={};u(b,s,(function(){return this}));var k=Object.getPrototypeOf,w=k&&k(k(T([])));w&&w!==n&&i.call(w,s)&&(b=w);var x=_.prototype=m.prototype=Object.create(b);function S(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function n(r,o,a,s){var l=p(e[r],e,o);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==typeof u&&i.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var r;o(this,"_invoke",{value:function(e,i){function o(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(o,o):o()}})}function A(t,n,r){var i=d;return function(o,a){if(i===f)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var l=O(s,r);if(l){if(l===v)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=f;var c=p(t,n,r);if("normal"===c.type){if(i=r.done?y:"suspendedYield",c.arg===v)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function O(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,O(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var o=p(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function T(t){if(t||""===t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(typeof t+" is not iterable")}return g.prototype=_,o(x,"constructor",{value:_,configurable:!0}),o(_,"constructor",{value:g,configurable:!0}),g.displayName=u(_,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,u(e,c,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},S(E.prototype),u(E.prototype,l,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new E(h(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(x),u(x,c,"Generator"),u(x,s,(function(){return this})),u(x,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=T,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;C(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:T(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function c(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}function d(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y,v,m=c((function e(){s(this,e)}),[{key:"asCss",value:function(){throw new Error("not implemented")}}]),g=function(e){function n(){return s(this,n),t(this,n,arguments)}return u(n,m),c(n,[{key:"section",value:function(){throw new Error("not implemented")}},{key:"endCss",value:function(){throw new Error("not implemented")}}])}(),_=function(e){function n(){return s(this,n),t(this,n,arguments)}return u(n,m),c(n,[{key:"match",value:function(){throw new Error("not implemented")}},{key:"property",value:function(){throw new Error("not implemented")}},{key:"endSection",value:function(){throw new Error("not implemented")}}])}(),b=function(e){function n(){return s(this,n),t(this,n,arguments)}return u(n,m),c(n)}(),k=function(e){function n(e){var r;s(this,n),r=t(this,n);var i=e=e||{},o=i.name,a=i.value,l=i.important,c=i.parent;return r._name=o,r._value=a,r._important=l||!1,r._parent=c,r}return u(n,b),c(n,[{key:"important",set:function(e){this._important=e}},{key:"asCss",value:function(e){var t=e=e||{},n=t.important;return t.format,n=n||this._important,"".concat(this._name,":").concat(this._value).concat(n?" !important":"",";")}}])}(),w=function(e){function n(e){var r,i=e.matches,o=e.important,a=e.parent;return s(this,n),(r=t(this,n))._matches=i||[],r._properties=[],r._important=o||!1,r._parent=a,r}return u(n,_),c(n,[{key:"match",value:function(e){return this._matches.push(e),this}},{key:"property",value:function(e,t,n){var r=new k({name:e,value:t,important:n,parent:this});return this._properties.push(r),this}},{key:"endSection",value:function(){return this._parent}},{key:"asCss",value:function(e){var t=e=e||{},n=t.important,r=t.format;return n=n||this._important,"".concat(this._matches.join(","),"{").concat(this._properties.map((function(e){return e.asCss({important:n,format:r})})).join(""),"}")}}])}(),x=function(e){function n(e){var r;s(this,n),r=t(this,n);var i=e=e||{},o=i.onEnd,a=i.important;return r._sections=[],r._important=a||!1,r._onEnd=o,r}return u(n,g),c(n,[{key:"section",value:function(e){var t=(e=e||{}).important,n=new w({important:t,parent:this});return this._sections.push(n),n}},{key:"endCss",value:function(){(0,this._onEnd)(this)}},{key:"asCss",value:function(e){var t=e=e||{},n=t.important,r=t.format;return n=n||this._important,this._sections.map((function(e){return e.asCss({important:n,format:r})})).join("")}}])}(),S=c((function e(){s(this,e)}),[{key:"setCssProperty",value:function(e,t,n){e&&(e.style[t]=n)}},{key:"setCssProperties",value:function(e,t){var n=this;e&&Object.keys(t).forEach((function(r){n.setCssProperty(e,r,t[r])}))}},{key:"installCss",value:function(e){var t=document.createElement("style");t.type="text/css",t.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(t)}},{key:"startFluentCss",value:function(e){var t=e.important,n=e.format,r=this;return new x({onEnd:function(e){var i=e.asCss({important:t,format:n});r.installCss(i)}})}},{key:"setHtmlContent",value:function(e,t){e.innerHTML=t}},{key:"setTextContent",value:function(e,t){e.innerText=t}},{key:"createElement",value:function(e,t){var n=document.createElement(e),r=this;return t&&Object.keys(t).forEach((function(e){switch(e){case"attr":var i=t.attr;Object.keys(i).forEach((function(e){n[e]=i[e]}));break;case"style":r.setCssProperties(n,t.style);break;case"id":n.id=t.id;break;case"className":n.classList.add(t.className);break;case"classNames":var a;(a=n.classList).add.apply(a,d(t.classNames));break;case"parent":var s=t.parent;s&&s.appendChild(n);break;case"html":r.setHtmlContent(n,t.html);break;case"text":r.setTextContent(n,t.text);break;case"onClick":n.addEventListener("click",t.onClick);break;case"onChange":n.addEventListener("change",(function(e){return t.onChange(e.target.value)}));break;case"onInput":n.addEventListener("input",(function(e){return t.onInput(e.target.value)}));break;case"onLoad":n.addEventListener("load",(function(){return t.onLoad()}));break;case"content":var l=function(e){e.forEach((function(e){e instanceof HTMLElement?n.appendChild(e):o(e)===o("")?n.appendChild(document.createTextNode(e)):o(e)===o([])&&l(e)}))};l(t.content);break;case"onInstance":(0,t.onInstance)(n)}})),n}},{key:"remove",value:function(e){e&&e.parentNode&&e.parentNode.removeChild(e)}},{key:"getElementsByClassName",value:function(e){return d(document.getElementsByClassName(e))}},{key:"getElementsByTagName",value:function(e){return d(document.getElementsByTagName(e))}},{key:"addClass",value:function(e,t){e&&e.classList.add(t)}},{key:"removeClass",value:function(e,t){e&&e.classList.remove(t)}},{key:"setClass",value:function(e,t,n){e&&(n?e.classList.add(t):e.classList.remove(t))}},{key:"removeClassStartingWith",value:function(e,t){e&&d(e.classList).filter((function(e){return e.startsWith(t)})).forEach((function(t){e.classList.remove(t)}))}}]),E=c((function e(t){var n=this,r=t.domAccess,i=t.parent;s(this,e),this._domAccess=r,this._parent=i,this._image=null,this._div=r.createElement("div",{parent:i,className:"qilvgallery_image_outter",content:[r.createElement("a",{parent:this._div,onInstance:function(e){return n._a=e}})]})}),[{key:"accessKey",set:function(e){this._a.accesskey=e}},{key:"setIsLoaded",value:function(){this._domAccess.removeClass(this._image,"qilv_loading")}},{key:"setLoading",value:function(){this._domAccess.addClass(this._image,"qilv_loading")}},{key:"replaceImage",value:function(e){var t=this;null!=this._image&&this._image.remove(),this._image=this._domAccess.createElement("img",{classNames:["qilvgallery_image"],parent:this._a,onLoad:function(){return t.setIsLoaded()},attr:{src:"#"}}),this.setLoading(),this._image.src=e,this._a.href=e,this._a.target="_blank",this._a.download=e.split("/").reduce((function(e,t){return t}))}},{key:"hide",value:function(){this._domAccess.removeClass(this._div,"qilv_shown")}},{key:"show",value:function(){this._domAccess.addClass(this._div,"qilv_shown")}},{key:"imageSource",get:function(){return this._image?this._image.src:null}}]),A=c((function e(t){var n=t.imageOverlayUi;return s(this,e),this._imageOverlayUi=n,null}),[{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"update",value:function(e,t){this.id=e,this._imageOverlayUi.replaceImage(t)}},{key:"hide",value:function(){this._imageOverlayUi.hide(),this._imageOverlayUi.accessKey=void 0}},{key:"show",value:function(){this._imageOverlayUi.accessKey="l",this._imageOverlayUi.show()}},{key:"imageSource",get:function(){return this._imageOverlayUi.imageSource}}]),O=c((function e(){s(this,e)}),[{key:"getBindableMethods",value:function(){return null}},{key:"getKeyBindings",value:function(){return null}}]),I=c((function e(t){var n=this,r=t.config;s(this,e),this._config=r;var i={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_MULTIPLY:106,NUMPAD_ADD:107,NUMPAD_ENTER:108,NUMPAD_SUBSTRACT:109,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,COMMA:188,PERIOD:190};this._keyValuesByName=i,this.globalBindings={},this.handle_key_elements=[],this._reverseKeysByNumber={},this.keys=[],this.values=[],Object.keys(i).forEach((function(e){var t=n._keyValuesByName[e];n._reverseKeysByNumber[t]=e,n.keys.push(e),n.values.push(t)}))}),[{key:"getName",value:function(e){return null==this._reverseKeysByNumber[e]?"".concat(e):this._reverseKeysByNumber[e]}},{key:"getValue",value:function(e){return e=e.toUpperCase(),this._keyValuesByName[e]}},{key:"handle_key",value:function(e){if(!(e.ctrlKey||e.shiftKey||e.altKey)&&null!=this.globalBindings[e.which]){var t=this.globalBindings[e.which],n=t.target,r=t.methodName;n[r]({event:e,method_name:r}),e.preventDefault(),e.stopPropagation()}}},{key:"auto_bind",value:function(e,t){var n=this;null==t&&(t=document);var r=e.getBindableMethods(),i=e.getKeyBindings();null==r&&(r={});var o=[];Object.keys(this.globalBindings).forEach((function(t){n.globalBindings[t].target===e&&o.push(t)})),o.forEach((function(e){delete n.globalBindings[e]})),Object.keys(i).forEach((function(t){var o=i[t];n.globalBindings[n.getValue(t)]={target:e,methodName:o},-1==Object.keys(r).indexOf(o)&&(r[o]="??? ("+o+")")})),this.keys.forEach((function(t){var r=n._config["VK."+t];if(null!=r){var i=e.__name__;i=i?i+".":"",r.substring(0,i.length)===i&&(""===(r=r.substring(i.length))?delete n.globalBindings[n.getValue(t)]:n.globalBindings[n.getValue(t)]={target:e,methodName:r})}})),0>this.handle_key_elements.indexOf(t)&&(this.handle_key_elements.push(t),t.addEventListener("keydown",(function(e){return n.handle_key(e)})))}}]),C=c((function e(t){var n=t.domAccess;s(this,e),this._domAccess=n,this._preloadGauge=null,this._preloadGaugeInner=null}),[{key:"createBlackScreen",value:function(e){var t=e.parent;return this._domAccess.createElement("div",{parent:t,id:"qilvgallery_black_screen"})}},{key:"removeBlackScreen",value:function(e){this._domAccess.remove(e)}},{key:"createInfoTip",value:function(e){var t=this._domAccess;void 0===e&&(e={});var n={className:"qilvgallery_infotip"};void 0!==n.id&&(n.id=e.id),e.parent&&(n.parent=e.parent),e.content&&(n.content=e.content),e.classNames&&(n.classNames=e.classNames);var r=t.createElement("div",n);return e.position&&t.setCssProperty(r,"position",e.position),void 0!==e.center&&e.center&&r.classList.add("qilvgallery_infotip_center"),void 0!==e.fadeOut&&setTimeout((function(){return t.remove(r)}),e.fadeOut),r}},{key:"createTempMessage",value:function(e,t){this.createInfoTip({fadeOut:1500,parent:t,position:"fixed",content:[e]})}},{key:"removeInfoBox",value:function(e){e&&this._domAccess.remove(e)}},{key:"createInfoBox",value:function(e){var t=e.parent,n=e.hrefs,r=e.isCurrent,i=this._domAccess,o=this.createInfoTip({parent:t}),a=i.createElement("pre",{parent:o,content:[n.map((function(e){var t="span";return r(e)&&(t="b"),[i.createElement(t,{text:e}),i.createElement("br")]}))],onClick:function(){var e="",t=0,r=0;n.forEach((function(n){e+=n,e+="\n",r+=1,n.length>t&&(t=n.length)})),i.remove(a),i.createElement("textarea",{parent:o,attr:{rows:"".concat(r+1),cols:"".concat(t+2),className:"qilvgallery_infobox_textarea",readonly:1,value:e}}).select()}});return o}},{key:"showPreloadGauge",value:function(e){var t=e.parent,n=e.onComplete,r=e.preloadGaugeInfo;if(!r){var i=this._domAccess.createElement("div",{parent:t,className:"qilvgallery_preload_gauge"});r={preloadGauge:i,preloadGaugeInner:this._domAccess.createElement("div",{parent:i,className:"qilvgallery_preload_gauge_inner"}),onComplete:n}}return r}},{key:"hidePreloadGauge",value:function(e){var t=e.preloadGaugeInfo;t&&(this._domAccess.remove(t.preloadGaugeInner),this._domAccess.remove(t.preloadGauge))}},{key:"updatePreloadGauge",value:function(e){var t=e.loaded,n=e.total,r=e.preloadGaugeInfo;if(r){var i=this._domAccess,o="".concat(Math.floor(100*t/n),"%");i.setCssProperty(r.preloadGaugeInner,"width",o),i.setTextContent(r.preloadGaugeInner,o),i.setTextContent(r.preloadGaugeInner,"".concat(t," / ").concat(n)),t===n&&r.onComplete()}}},{key:"ensurePreloadAll",value:function(e){var t=this,n=e.hrefs,r=e.onImageLoaded,i=e.parent;if(!this._preloadAllPanel){var o=this._domAccess;this._preloadAllPanel=o.createElement("div",{parent:i,id:"qilvgallery_preload_all_panel"}),n.forEach((function(e){o.createElement("img",{parent:t._preloadAllPanel,onLoad:r,attr:{src:"#"}}).src=e}))}}},{key:"resetImageList",value:function(){this._preloadAllPanel&&this._domAccess.remove(this._preloadAllPanel),this._preloadAllPanel=null}},{key:"removeAboutInfoBox",value:function(e){this._domAccess.remove(e)}},{key:"createAboutInfoBox",value:function(e){var t=e.parent,n=e.onClick,r=e.version,i=this._domAccess,o="https://github.com/webgiss/qilvgallery";return i.createElement("div",{parent:t,className:"qilvgallery_about_infobox",content:[i.createElement("div",{className:"qilvgallery_infotip_about_blackscreen",onClick:n}),this.createInfoTip({id:"QILVGallery_About",center:!0,classNames:["qilvgallery_infotip_about"],content:[i.createElement("p",{text:"QILV Gallery",className:"qilvgallery_infotip_about_title"}),i.createElement("p",{text:"Version : ".concat(r),className:"qilvgallery_infotip_about_version"}),i.createElement("a",{text:o,attr:{href:o,target:"_blank"}}),i.createElement("br"),i.createElement("div",{text:"Close",className:"qilvgallery_infotip_about_button",onClick:n})]})]})}},{key:"removeHelpInfoTip",value:function(e){this._domAccess.remove(e)}},{key:"createHelpInfoTip",value:function(e){var t=e.parent,n=e.bindings,r=e.configurations,i=e.version,o=this._domAccess;return this.createInfoTip({parent:t,classNames:["qilvgallery_infotip_help"],content:[o.createElement("p",{text:"Version: ".concat(i)}),o.createElement("h1",{text:"Keyboard configuration",className:"qilvgallery_infotip_help_title"}),o.createElement("div",{className:"qilvgallery_infotip_help_content",content:n.map((function(e){var t=e.keyName,n=e.methodName;return o.createElement("div",{content:[o.createElement("b",{text:t}),o.createElement("span",{text:": ".concat(n)})]})}))}),o.createElement("h1",{text:"Values",className:"qilvgallery_infotip_help_title"}),o.createElement("div",{className:"qilvgallery_infotip_help_content",content:r.map((function(e){var t=e.comment,n=e.configured,r=e.effective,i=e.defaultValue;return o.createElement("div",{content:[o.createElement("b",{text:t}),o.createElement("span",{text:": ".concat(r," (configured = ").concat(n," ; default = ").concat(i,")")})]})}))})]})}},{key:"createMainElement",value:function(){return this._domAccess.createElement("div",{parent:document.body,id:"qilvgallery_main_element"})}},{key:"createViewer",value:function(e){var t=e.parent;return this._domAccess.createElement("div",{parent:t,id:"qilvgallery_viewer"})}},{key:"getLinkRefs",value:function(){return this._domAccess.getElementsByTagName("a").map((function(e){return{href:e.href,element:e}}))}},{key:"setImageRef",value:function(e){var t=e.element,n=e.id;this._domAccess.addClass(t,"qilvgallery_source_image"),this._domAccess.addClass(t,"qilvgallery_source_image_".concat(n))}},{key:"cleanImageRef",value:function(e){var t=e.element,n=e.id;this._domAccess.removeClass(t,"qilvgallery_source_image"),this._domAccess.removeClass(t,"qilvgallery_source_image_".concat(n))}},{key:"setRelative",value:function(e){var t=e.element,n=e.relative;this._domAccess.setClass(t,"qilv_relative",n)}},{key:"setAutoX",value:function(e){var t=e.element,n=e.autoX;this._domAccess.setClass(t,"qilv_autoX",n)}},{key:"setAutoY",value:function(e){var t=e.element,n=e.autoY;this._domAccess.setClass(t,"qilv_autoY",n)}},{key:"setCentered",value:function(e){var t=e.element,n=e.centered;this._domAccess.setClass(t,"qilv_centered",n)}},{key:"setMaxSize",value:function(e){var t=e.element,n=e.maxSize;this._domAccess.setClass(t,"qilv_maxSize",n)}},{key:"setShown",value:function(e){var t=e.element,n=e.shown;this._domAccess.setClass(t,"qilv_shown",n)}},{key:"setTransition",value:function(e){var t=e.element,n=e.transitionTime;this._domAccess.removeClassStartingWith(t,"qilv_transition-"),this._domAccess.addClass(t,"qilv_transition-".concat(n))}},{key:"installCss",value:function(){this._domAccess.startFluentCss({important:!0}).section().match("#qilvgallery_viewer").property("position","absolute").property("z-index","50000").property("display","none").property("top","0").property("bottom","0").property("margin","0").property("left","0").property("right","0").endSection().section().match("#qilvgallery_viewer.qilv_shown").property("z-index","50001").property("display","block").endSection().section().match("#qilvgallery_viewer.qilv_relative").property("position","fixed").endSection().section().match(".qilvgallery_infotip").property("display","block").property("position","absolute").property("left","4px").property("top","4px").property("padding","15px").property("font-size","13px").property("background","linear-gradient(180deg, #f8f8f8, #dddddd)").property("color","#000000").property("font-family",'"consolas","courier new",monospace').property("border","2px solid").property("border-color","#ffffff #f8f8f8 #b8b8b8 #f8f8f8").property("border-radius","5px").property("z-index","50001").endSection().section().match(".qilvgallery_infotip > pre").property("margin","0").endSection().section().match(".qilvgallery_preload_gauge").property("z-index","50101").property("border","1px solid black").property("width","100%").property("position","fixed").property("bottom","0").property("height","13px").property("background-color","#eee").endSection().section().match(".qilvgallery_preload_gauge_inner").property("z-index","50102").property("border","0").property("padding","0").property("margin","0").property("width","0%").property("position","static").property("left","0").property("top","0").property("height","100%").property("background-color","#f03").property("text-align","center").property("font-size","11px").property("font-family","Arial,Verdana,sans-serif,Helvetica").property("font-weight","bold").property("color","#000000").endSection().section().match(".qilvgallery_infotip_about_blackscreen").property("z-index","50098").property("width","100%").property("height","100%").property("position","fixed").property("left","0px").property("top","0px").property("background","black").property("opacity","0.8").endSection().section().match(".qilvgallery_infotip_about_title").property("font-size","20pt").endSection().section().match(".qilvgallery_infotip_about_button").property("width","20em").property("border","1px solid #666").property("background","#ccc").property("border-radius","8px").property("background","linear-gradient(0, #aaa, #eee)").property("left","0px").property("right","0px").property("margin","100px auto auto").endSection().section().match(".qilvgallery_infotip_center").property("position","fixed").property("left","0").property("right","0").property("top","0").property("bottom","0").property("margin","auto").endSection().section().match(".qilvgallery_infotip_about").property("font-family",'"Trebuchet MS","Tahoma","Verdana","Arial","sans-serif"').property("font-size","15pt").property("text-align","center").property("max-width","500px").property("max-height","300px").property("border","1px solid white").property("background","linear-gradient(180deg, #f8f8f8, #dddddd)").property("z-index","50100").endSection().section().match(".qilvgallery_infotip_help").property("display","block").property("position","absolute").property("left","4px").property("top","4px").property("padding","15px").property("font-size","13px").property("border","1px solid white").property("background","linear-gradient(180deg, #f8f8f8, #dddddd)").property("color","#000000").property("font-family",'"courier new"').property("border-radius","5px").property("z-index","50001").endSection().section().match(".qilvgallery_infotip_help_title").property("font-size","2em").property("font-weight","bold").endSection().section().match(".qilvgallery_infotip_help_content").property("margin-left","10px").endSection().section().match(".qilvgallery_infobox_textarea").property("white-space","pre").endSection().section().match(".qilvgallery_about_infobox").property("margin","0").property("padding","0").property("border","0").endSection().section().match(".qilvgallery_image_outter").property("margin","0").property("padding","0").property("border","0").property("position","absolute").property("display","block").property("opacity","0").property("left","0").property("right","0").property("top","0").property("bottom","0").property("transition","opacity ease-out").property("transition-duration","0s").endSection().section().match(".qilv_transition-300 .qilvgallery_image_outter").property("transition-duration","0.3s").endSection().section().match(".qilv_transition-800 .qilvgallery_image_outter").property("transition-duration","0.8s").endSection().section().match(".qilv_transition-1500 .qilvgallery_image_outter").property("transition-duration","1.5s").endSection().section().match(".qilvgallery_image_outter.qilv_shown").property("opacity","1").property("display","block").endSection().section().match(".qilvgallery_image").property("margin","unset").property("padding","0").property("display","block").property("position","absolute").property("left","0").property("top","0").property("z-index","50000").property("box-sizing","border-box").property("border","2px solid black").property("right","unset").property("bottom","unset").property("width","auto").property("height","auto").property("max-width","unset").property("max-height","unset").endSection().section().match(".qilv_maxSize .qilvgallery_image").property("max-width","100%").property("max-height","100%").endSection().section().match(".qilv_autoX .qilvgallery_image").property("width","100%").endSection().section().match(".qilv_autoY .qilvgallery_image").property("height","100%").endSection().section().match(".qilvgallery_image.qilv_loading").property("border","2px solid red").endSection().section().match(".qilv_centered .qilvgallery_image").property("right","0").property("bottom","0").property("margin","auto").endSection().section().match("#qilvgallery_preload_all_panel").property("display","none").endSection().section().match("#qilvgallery_black_screen").property("z-index","499998").property("width","100%").property("height","100%").property("left","0").property("top","0").property("background","black").property("margin","0").property("padding","0").endSection().endCss()}}]),L=c((function e(t){var n=t.domAccess;s(this,e),this._domAccess=n}),[{key:"createImageOverylay",value:function(e){var t=this._domAccess,n=new E({domAccess:t,parent:e});return new A({imageOverlayUi:n})}}]),T=function(e){function n(e){var r,i=e.imageOverlayFactory,o=e.galleryOverlaysUi,a=e.vk,l=e.config,c=e.streamAccess;return s(this,n),(r=t(this,n))._imageOverlayFactory=i,r._galleryOverlaysUi=o,r._vk=a,r._config=l,r._preloadGaugeInfo=null,r._streamAccess=c,r._configurables={slideshowSpeed:{label:"Initial slideshow speed (ms)",default:"500"},transitionTime:{label:"Initial transition's effect's time (ms)",default:"0"},slideshowMode:{label:"Slideshow on at start ?",default:"false"},preloadAllMode:{label:"Preload all at start ?",default:"true"},maxSize:{label:"Fit the image to the screen if bigger than the screen at start ?",default:"true"},relative:{label:"Show image at the top of the screen instead of the top of the page at start ?",default:"true"},blackScreenMode:{label:"Show on 'black screen' mode at start ?",default:"true"}},r._bindables={goPrev:"Go to previous image",goNext:"Go to next image",toggleInfoBox:"Show/hide the infobox of image list",toggle:"Show/Hide the current image",openLink:"Open the image in a new window/tab",toggleSlideshow:"Start/stop the slideshow",togglePosition:"Show current image at top of the page/top of the screen",speedUpSlideshow:"Increase the slideshow speed",speedDownSlideshow:"Decrease the slideshow speed",toggleMaxSize:"Fit the image if larger than the screen/Show whole image",toggleAutoX:"Width of the image fit/doesn't fit to width of the screen",toggleAutoY:"Height of the image fit/doesn't fit to height of the screen",toggleAutoXY:"Width and height of the image fit/doesn't fit to width and height of the screen",toggleBlackScreen:"Set or remove the black screen",cycleTransitionTime:"Change transition's effect's time",preloadAll:"Pre-load all images (may take some resources)",reload:"Reload images (after changes in page content)",about:"Show/Hide about box",help:"Show/Hide help box"},r._key_bindings={BACKSPACE:"goPrev",J:"goPrev",SPACE:"goNext",K:"goNext",I:"toggleInfoBox",H:"toggle",L:"openLink",D:"downloadLink",W:"downloadAllLinks",S:"toggleSlideshow",R:"togglePosition",NUMPAD_ADD:"speedUpSlideshow",NUMPAD_SUBSTRACT:"speedDownSlideshow",M:"toggleMaxSize",X:"toggleAutoX",Y:"toggleAutoY",Z:"toggleAutoXY",B:"toggleBlackScreen",T:"cycleTransitionTime",P:"preloadAll",E:"reload",NUMPAD_MULTIPLY:"help",NUMPAD_DIVIDE:"about"},r.__name__="Gallery",r._prev=null,r._next=null,r._current=null,r._slideshowMode=null,r._preloadAllMode=null,r._slideshowSpeed=null,r._transitionTime=null,r._maxSize=null,r._relative=!0,r._blackScreenMode=null,r._slideshowDirNext=!0,r._autoX=!1,r._autoY=!1,r._centered=!1,r._blackScreen=null,r._shown=!0,r}return u(n,O),c(n,[{key:"getBindableMethods",value:function(){return this._bindables}},{key:"getKeyBindings",value:function(){return this._key_bindings}},{key:"getConfigurables",value:function(){return this._configurables}},{key:"autoX",get:function(){return this._autoX},set:function(e){this._autoX=e,this._galleryOverlaysUi.setAutoX({element:this._viewer,autoX:this._autoX})}},{key:"autoY",get:function(){return this._autoY},set:function(e){this._autoY=e,this._galleryOverlaysUi.setAutoY({element:this._viewer,autoY:this._autoY})}},{key:"ImageOverlays",get:function(){var e=this;return["prev","next","current"].map((function(t){return e["_"+t]}))}},{key:"setTransitionTime",value:function(e,t){this._transitionTime=e,this._galleryOverlaysUi.setTransition({element:this._viewer,transitionTime:e}),t||this.createTempMessage("Transition's effect's time : ".concat(e," ms"))}},{key:"createTempMessage",value:function(e){this._galleryOverlaysUi.createTempMessage(e,this._mainElement)}},{key:"transitionTime",get:function(){return this._transitionTime},set:function(e){this.setTransitionTime(e,!0)}},{key:"cycleTransitionTime",value:function(){var e=this._transitionTime;e=0===e?300:300>=e?800:800>=e?1500:0,this.setTransitionTime(e)}},{key:"centered",get:function(){return this._centered},set:function(e){this._centered=e,this._galleryOverlaysUi.setCentered({element:this._viewer,centered:this._centered})}},{key:"setBlackScreenMode",value:function(e){e&&!this._blackScreen&&(this._blackScreen=this._galleryOverlaysUi.createBlackScreen({parent:this._viewer})),!e&&this._blackScreen&&(this._galleryOverlaysUi.removeBlackScreen(this._blackScreen),this._blackScreen=null),this.centered=e}},{key:"blackScreenMode",get:function(){return this._blackScreenMode},set:function(e){this._blackScreenMode=e,this.setBlackScreenMode(e)}},{key:"slideshowMode",get:function(){return this._slideshowMode},set:function(e){this._slideshowMode=e,this._slideshowMode&&this.prepareNextSlide()}},{key:"preloadAllMode",get:function(){return this._preloadAllMode},set:function(e){this._preloadAllMode=e,this._preloadAllMode&&this.preloadAll({parent:this._mainElement})}},{key:"shown",get:function(){return this._shown},set:function(e){this._shown=e,this._galleryOverlaysUi.setShown({element:this._viewer,shown:this._shown})}},{key:"showSlideshowSlide",value:function(){this.slideshowMode&&(this._slideshowDirNext?this.goNext():this.goPrev(),this.prepareNextSlide())}},{key:"prepareNextSlide",value:function(){var e=this;setTimeout((function(){return e.showSlideshowSlide()}),this._slideshowSpeed)}},{key:"toggleSlideshow",value:function(){this.slideshowMode=!this.slideshowMode}},{key:"slideshowSpeed",get:function(){return this._slideshowSpeed},set:function(e){this.setSlideshowSpeed(e,!1)}},{key:"setSlideshowSpeed",value:function(e,t){this._slideshowSpeed=e,t||this.createTempMessage("Speed : ".concat(this._slideshowSpeed," ms"))}},{key:"speedUpSlideshow",value:function(){100<this.slideshowSpeed&&(this.slideshowSpeed-=100)}},{key:"speedDownSlideshow",value:function(){this.slideshowSpeed+=100}},{key:"goPrev",value:function(){this._slideshowDirNext=!1,this._current.hide();var e=[this._current,this._prev,this._next];this._next=e[0],this._current=e[1],this._prev=e[2],this._current.show();var t=this._current.id,n=this._links[t].prevId;this._prev.update(n,this._links[n].href),this.removeBoxes(),this.shown=!0}},{key:"goNext",value:function(){this._slideshowDirNext=!0,this._current.hide();var e=[this._next,this._current,this._prev];this._current=e[0],this._prev=e[1],this._next=e[2],this._current.show();var t=this._current.id,n=this._links[t].nextId;this._next.update(n,this._links[n].href),this.removeBoxes(),this.shown=!0}},{key:"goNum",value:function(e){var t=this._links[e].prevId,n=this._links[e].nextId;this._current.update(e,this._links[e].href),this._prev.update(t,this._links[t].href),this._next.update(n,this._links[n].href),this.removeBoxes(),this.shown=!0}},{key:"removeBoxes",value:function(){this.removeInfoBox(),this.removeAbout(),this.removeHelp()}},{key:"maxSize",get:function(){return this._maxSize},set:function(e){this.setMaxSize(e,!1)}},{key:"setMaxSize",value:function(e){this._maxSize=e,this._galleryOverlaysUi.setMaxSize({element:this._viewer,maxSize:this._maxSize})}},{key:"toggleMaxSize",value:function(){this.maxSize=!this.maxSize}},{key:"toggleAutoX",value:function(){this.autoX=!this.autoX}},{key:"toggleAutoY",value:function(){this.autoY=!this.autoY}},{key:"toggleAutoXY",value:function(){this.autoX||this.autoY?(this.autoX=!1,this.autoY=!1):(this.autoX=!0,this.autoY=!0)}},{key:"isCurrent",value:function(e){return this._current.imageSource===e}},{key:"removeInfoBox",value:function(){this._infoBox&&(this._galleryOverlaysUi.removeInfoBox(this._infoBox),this._infoBox=null)}},{key:"toggleInfoBox",value:function(){var e=this;this._infoBox?this.removeInfoBox():this._infoBox=this._galleryOverlaysUi.createInfoBox({hrefs:Object.values(this._links).map((function(e){return e.href})),isCurrent:function(t){return e.isCurrent(t)},parent:this._mainElement})}},{key:"toggle",value:function(){this.shown=!this.shown}},{key:"togglePosition",value:function(){this.relative=!this.relative}},{key:"relative",get:function(){return this._relative},set:function(e){this._relative=e,this._galleryOverlaysUi.setRelative({element:this._viewer,relative:this._relative})}},{key:"toggleBlackScreen",value:function(){this.blackScreenMode=!this.blackScreenMode}},{key:"openLink",value:function(){window.open(this._current.imageSource)}},{key:"downloadLink",value:function(){this._streamAccess.downloadUrl(this._current.imageSource)}},{key:"downloadAllLinks",value:function(){var e=this;Object.values(this._links).forEach((function(t){var n=t.href;return e._streamAccess.downloadUrl(n)}))}},{key:"showPreloadGauge",value:function(){var e=this;this._preloadGaugeInfo=this._galleryOverlaysUi.showPreloadGauge({parent:this._mainElement,onComplete:function(){return e.hidePreloadGauge()},preloadGaugeInfo:this._preloadGaugeInfo}),this.updatePreloadGauge()}},{key:"hidePreloadGauge",value:function(){this._galleryOverlaysUi.hidePreloadGauge({preloadGaugeInfo:this._preloadGaugeInfo}),this._preloadGaugeInfo=null}},{key:"updatePreloadGauge",value:function(){this._galleryOverlaysUi.updatePreloadGauge({loaded:this._loaded,total:this._totalToLoad,preloadGaugeInfo:this._preloadGaugeInfo})}},{key:"preloadAll",value:function(e){var t=this,n=e.parent,r=Object.values(this._links).map((function(e){return e.href}));this._loaded=0,this._totalToLoad=r.length,this._galleryOverlaysUi.ensurePreloadAll({hrefs:r,onImageLoaded:function(){t._loaded+=1,t.updatePreloadGauge()},parent:n}),this._preloadGaugeInfo||this.showPreloadGauge()}},{key:"about",value:function(){var e=this;this._aboutInfoBox?this.removeAbout():this._aboutInfoBox=this._galleryOverlaysUi.createAboutInfoBox({parent:this._mainElement,onClick:function(){e.removeAbout()},version:"4.0.0 - 144644e"})}},{key:"removeAbout",value:function(){null!=this._aboutInfoBox&&(this._galleryOverlaysUi.removeAboutInfoBox(this._aboutInfoBox),this._aboutInfoBox=null)}},{key:"help",value:function(){var e=this;if(this._helpInfoTip)this.removeHelp();else{var t=[],n=[];Object.keys(this._vk.globalBindings).forEach((function(n){var r=e._vk.globalBindings[n],i=e.getBindableMethods();if(r&&r.target===e){var o=r.methodName;t.push({keyName:e._vk.getName(n),methodName:o in i?i[o]:o})}})),Object.keys(this._configurables).forEach((function(t){var r=e._configurables[t].label,i=e._config["QILV."+t]||void 0,o=e._configurables[t].default,a=e[t];n.push({comment:r,configured:i,effective:a,defaultValue:o})})),this._helpInfoTip=this._galleryOverlaysUi.createHelpInfoTip({parent:this._mainElement,bindings:t,configurations:n,version:"4.0.0 - 144644e"})}}},{key:"removeHelp",value:function(){this._helpInfoTip&&(this._galleryOverlaysUi.removeHelpInfoTip(this._helpInfoTip),this._helpInfoTip=null)}},{key:"init",value:function(){var e=this;this._mainElement=this._galleryOverlaysUi.createMainElement(),this._viewer=this._galleryOverlaysUi.createViewer({parent:this._mainElement}),this._galleryOverlaysUi.installCss(),this._prev=this._imageOverlayFactory.createImageOverylay(this._viewer),this._current=this._imageOverlayFactory.createImageOverylay(this._viewer),this._next=this._imageOverlayFactory.createImageOverylay(this._viewer),this._links={},this.reload(),this._vk.auto_bind(this),Object.keys(this._configurables).forEach((function(t){var n=e._config["QILV."+t]||e._configurables[t].default;null!=n&&(n.match(/^\-?[0-9]+$/)&&(n=parseInt(n)),"false"===n&&(n=!1),"true"===n&&(n=!0),e["_"+t]=n)})),this._current.show(),this.preloadAllMode=this._preloadAllMode,this.relative=this._relative,this.autoX=this._autoX,this.autoY=this._autoY,this.setMaxSize(this._maxSize,!0),this.centered=this._centered,this.blackScreenMode=this._blackScreenMode,this.transitionTime=this._transitionTime,this.slideshowMode=this._slideshowMode,this.setSlideshowSpeed(this._slideshowSpeed,!0),this.shown=this._shown}},{key:"reload",value:function(){var e=this,t=null;Object.values(this._links).forEach((function(t){var n=t.id;t.prevId,t.nextId,t.href;var r=t.element;e._galleryOverlaysUi.cleanImageRef({element:r,id:n})})),this._links={},this._galleryOverlaysUi.resetImageList();var n=this._galleryOverlaysUi.getLinkRefs().filter((function(e){var n=e.href,r=e.element,i=!1;return n&&[".png",".gif",".jpg",".jpeg"].map((function(e){-1===n.indexOf("?")&&-1===n.indexOf("/http://")&&-1===n.indexOf("/https://")&&n.substring(n.length-e.length).toLowerCase()===e&&n!==t&&(i=!0)})),r&&r.parentElement&&r.parentElement.classList.contains("qilvgallery_image_outter")&&(i=!1),i&&(t=n),i}));return n.forEach((function(t,r){var i=t.element,o=t.href,a="".concat(r);e._galleryOverlaysUi.setImageRef({element:i,id:a});var s=0===r?n.length-1:r-1,l=r===n.length-1?0:r+1;e._links[a]={id:a,prevId:s,nextId:l,href:o,element:i}})),0==n.length?(this._galleryOverlaysUi.createTempMessage("No links to image found in this page !",document.body),this.slideshowMode=!1,void(this.blackScreenMode=!1)):(this.goNum(0),void(this.preloadAllMode&&this.preloadAll()))}},{key:"bindables",get:function(){return this._bindables},set:function(e){this._bindables=e}}])}(),N=function(e){return e.split("/").reduce((function(e,t){return t}))},P=c((function e(){s(this,e)}),[{key:"downloadUrl",value:(y=r().mark((function e(t,n){var i,o,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=N(t)),e.next=3,fetch(t);case 3:return i=e.sent,e.next=6,i.blob();case 6:o=e.sent,(a=document.createElement("a")).href=URL.createObjectURL(o),a.download=n,a.click();case 11:case"end":return e.stop()}}),e)})),v=function(){var e=this,t=arguments;return new Promise((function(n,r){var i=y.apply(e,t);function o(e){a(i,n,r,o,s,"next",e)}function s(e){a(i,n,r,o,s,"throw",e)}o(void 0)}))},function(){return v.apply(this,arguments)})}]),q=QILVGalleryInit=function(){if(window.QILVGalleryOverlays)window.QILVGalleryOverlays.reload(),window.QILVGalleryOverlays.shown=!0;else{var e=window.QILV_config||window.GM_values||{},t=new S,n=new L({domAccess:t}),r=new C({domAccess:t}),i=new I({config:e}),o=new P,a=new T({imageOverlayFactory:n,galleryOverlaysUi:r,vk:i,config:e,streamAccess:o});window.QILVGalleryOverlays=a,a.init()}};e.then((function(){return q()}));
